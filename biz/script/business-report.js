var tableViewData,list=new Array("Sales","Cost of Sales","Begin Inventory","Purchase Inventory","Available","End Inventory","Total Cost of sales","Operating Expences","Fuel and Oil","Wages and Salary","Utilities","Rental","Deprecesion","Investments","Miscelleneos","Office Supply","Prof Expences","Benefits","Total OE","Net Income");function getCalendar(){$("#loadthis").addClass("loader-show"),$(" .calendar_table").addClass("animated fadeIn");var a=[],t=$("#msme_id").val();a.push({name:"msme_id",value:t}),a.push({name:"action",value:"Get Calendar"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:a,success:function(a){$(" .calendar_table").html(jQuery.trim(a)).addClass("animated fadeIn"),(a=[]).push({name:"action",value:"Get current month and year"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:a,success:function(a){var t=JSON.parse(jQuery.trim(a));tableview(t[0],t[1]),chart(),$("#loadthis").removeClass("loader-show")}})}})}function chart(a){var t=$(a).attr("data-id"),e=$("#msme_id").val(),l=$("#year_").attr("data-id"),s=void 0==$(a).attr("data-file")?"Sales":$(a).attr("data-file");$("#report_title").html("Monthly "+s+" Report"),$("#chartContainer").removeClass("fadeIn");var n=[];n.push({name:"type",value:t}),n.push({name:"year",value:l}),n.push({name:"msme_id",value:e}),n.push({name:"action",value:"Get annual report"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:n,success:function(a){var t=JSON.parse(jQuery.trim(a));new CanvasJS.Chart("chartContainer",{data:[{type:"column",dataPoints:[{y:parseInt(t[0].Jan),label:"January"},{y:parseInt(t[0].Feb),label:"February"},{y:parseInt(t[0].Mar),label:"March"},{y:parseInt(t[0].Apr),label:"April"},{y:parseInt(t[0].May),label:"May"},{y:parseInt(t[0].June),label:"June"},{y:parseInt(t[0].July),label:"July"},{y:parseInt(t[0].Aug),label:"August"},{y:parseInt(t[0].Sept),label:"September"},{y:parseInt(t[0].Oct),label:"October"},{y:parseInt(t[0].Nov),label:"November"},{y:parseInt(t[0].Dec),label:"December"}]}]}).render(),$("#chartContainer").addClass("animated fadeIn")}})}function nextprev(a){$("#loadthis").addClass("loader-show");var t=$(a).attr("data-id"),e=$("#msme_id").val(),l=t.split("-"),s=l[0],n=l[1];$(" .calendar_table").removeClass("fadeIn");var o=[];o.push({name:"msme_id",value:e}),o.push({name:"ym",value:t}),o.push({name:"action",value:"Get Calendar"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:o,success:function(a){$(" .calendar_table").html(jQuery.trim(a)).addClass("animated fadeIn"),tableview(s,n),chart(),$("#loadthis").removeClass("loader-show")}})}function refreshtable(a){$(" .calendar_table").removeClass("fadeIn");var t=$("#msme_id").val(),e=[],l=a;e.push({name:"ym",value:l}),e.push({name:"msme_id",value:t}),e.push({name:"action",value:"Get Calendar"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:e,success:function(a){$(".calendar_table").html(jQuery.trim(a)).addClass("animated fadeIn")}})}function dateclick(a){$("#loadthis").addClass("loader-show");var t=$(a).attr("data-file"),e=$(a).attr("data-id"),l=$("#msme_id").val();$("#date").html(t),$("#date").val(e);var s=[];s.push({name:"date_report",value:e}),s.push({name:"msme_id",value:l}),s.push({name:"action",value:"Check Date"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:s,success:function(a){0!=(a=JSON.parse(jQuery.trim(a))).length&&void 0!=a&&($("#sales").val(a.sales),$("#begininventory").val(a.begin_inventory),$("#purchaseinventory").val(a.purchase_inventory),$("#available").val(a.available),$("#endinventory").val(a.end_inventory),$("#totalcostofsales").val(a.total_cost_sales),$("#fuelandoil").val(a.fuel_oil),$("#wagesandsalary").val(a.wages_salary),$("#rental").val(a.rental),$("#utilities").val(a.utilities),$("#investments").val(a.investments),$("#miscelleneos").val(a.miscellaneous),$("#officesupply").val(a.office_supply),$("#profexpences").val(a.pro_expences),$("#benefits").val(a.benefits),$("#totaloe").val(a.total_oe),$("#netincome").val(a.net_income),$("#deprecesion").val(a.deprecesion)),console.log(a),$("#loadthis").removeClass("loader-show"),$("#myModal").modal({show:!0})}})}function tableview(a,t){console.log(a),console.log(t);var e=$("#msme_id").val(),l=[];tableViewData="",l.push({name:"year",value:a}),l.push({name:"month",value:t}),l.push({name:"msme_id",value:e}),l.push({name:"action",value:"Table view"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:l,success:function(a){var t=JSON.parse(jQuery.trim(a));console.log(t),0!=t.length&&void 0!=t&&(tableViewData+="<tr>",tableViewData+='<th colspan="2" class="text-center bg-mycolor font-30 font-white font-size-"> Report for the Month of '+t[0].month_name+"</th>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="bold bg-color-F7FAFA">'+list[0]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_sales?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_sales))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="bold bg-color-F7FAFA" colspan="2">'+list[1]+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td cellpadding="9" width="300" class="p-l-50 bg-color-F7FAFA">'+list[2]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_begin_inventory?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_begin_inventory))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[3]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_purchase_inventory?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_purchase_inventory))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[4]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_available?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_available))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[5]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_end_inventory?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_end_inventory))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bold bg-color-F7FAFA">'+list[6]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_total_cost_sales?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_total_cost_sales))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" colspan="2" class="bold bg-color-F7FAFA">'+list[7]+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[8]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_fuel_oil?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_fuel_oil))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[9]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_wages_salary?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_wages_salary))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[10]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_utilities?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_utilities))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[11]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_rental?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_rental))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[12]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_deprecesion?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_deprecesion))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[13]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_investments?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_investments))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[14]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_miscellaneous?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_miscellaneous))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[15]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_office_supply?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_office_supply))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[16]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_pro_expences?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_pro_expences))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bg-color-F7FAFA">'+list[17]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_benefits?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_benefits))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="p-l-50 bold bg-color-F7FAFA">'+list[18]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_total_oe?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_total_oe))+"</td>",tableViewData+="</tr>",tableViewData+="<tr>",tableViewData+='<td  width="300" class="bold bg-color-F7FAFA">'+list[19]+"</td>",tableViewData+="<td>"+(void 0==t[0].monthly_net_income?0:"<span> &#8369;</span> "+numberWithCommas(t[0].monthly_net_income))+"</td>",tableViewData+="</tr>"),$(".table_view tbody").html(tableViewData)}})}function getMsmeInvestorNotify(a){var t=[];a=a;t.push({name:"msme_id",value:a}),t.push({name:"action",value:"Get msme investor who subscribe"}),$.ajax({type:"POST",url:"controller/MsmeController.php",data:t,success:function(t){var e=JSON.parse(jQuery.trim(t));if(console.log(e),e.length>0)for(i in e)b=e[i],notification(a,b.v_id,7)}})}function changeData(){var a=+removeCommas($("#begininventory").val()),t=+removeCommas($("#purchaseinventory").val()),e=+removeCommas($("#endinventory").val()),l=a+t;$("#available").val(numberWithCommas(l));var s=l-e;$("#totalcostofsales").val(numberWithCommas(s));for(var n=0,o=8;o<list.length-2;o++){var r=list[o].toString().toLowerCase().replace(/\s+/g,""),i=+removeCommas($("#"+r).val());n+=parseInt(i)}$("#totaloe").val(numberWithCommas(n));var d=+removeCommas($("#sales").val());$("#netincome").val(numberWithCommas(d-s-n))}function select_month(a){var t=$("#year_").attr("data-id")+"-"+$(a).attr("data-id"),e=$("#year_").attr("data-id"),l=$(a).attr("data-id");refreshtable(t),tableview(e,l)}function select_year(a){var t=$(a).attr("data-id")+"-"+$("#month_").attr("data-id"),e=$(a).attr("data-id"),l=$("#month_").attr("data-id");$("#year_").attr("data-id",e),refreshtable(t),tableview(e,l),chart()}function removeCommas(a){return a.toString().replace(/,/g,"")}function numberWithCommas(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function testDecimals(a){return null===a.match(/\./g)?0:a.match(/\./g)}function replaceCommas(a){var t=a.toString().split(".");return 1===t.length&&(t[0]=a),t[0]=t[0].replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),2===t.length&&(t[1]=t[1].replace(/\D/g,"")),t.join(".")}$("#save_report").click(function(){$("#save_report").html('<i class="fa fa-spinner"></i>'),$("#save_report").attr("disabled","true");for(var a=[],t=0;t<list.length;t++)if(7!=t||1!=t){var e=list[t].toString().toLowerCase().replace(/\s+/g,"");a.push({name:e,value:removeCommas($("#"+e).val())})}var l=$("#msme_id").val();a.push({name:"msme_id",value:l}),a.push({name:"date_report",value:$("#date").val()}),a.push({name:"action",value:"Add day report"}),$.ajax({type:"POST",url:"controller/ReportsController.php",data:a,success:function(a){if("success"==jQuery.trim(a)){notify("success-notify","Day Report Added");var t=$("#current_ym").attr("data-id"),e=t.split("-"),s=e[0],n=e[1];refreshtable(t),tableview(s,n),chart(),getMsmeInvestorNotify(l)}else notify("error-notify","Error");$("#save_report").text("Add report"),$("#save_report").removeAttr("disabled")}})}),$("input.haha").keyup(function(a){a.which>=37&&a.which<=40&&a.preventDefault();var t=$(this).val();testDecimals(t).length>1&&(console.log("You cannot enter more than one decimal point"),t=t.slice(0,-1)),$(this).val(replaceCommas(t))});